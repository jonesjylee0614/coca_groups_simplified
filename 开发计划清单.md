# COCA 5000 学习系统 - 开发计划清单

**生成日期**: 2025-11-17
**项目状态**: 基础功能完整,需要功能增强和优化

---

## 📊 项目概况

### 当前状态
- **代码行数**: 2204行 (JS: 868, CSS: 1145, HTML: 191)
- **核心功能**: 已实现双书籍系统、学习进度跟踪、多主题切换
- **Book 1**: 99组词汇 (缺少 group100_reading.md)
- **Book 2**: 200组词汇 (完整)

---

## 🔴 一、未完成的功能

### 1.1 核心学习功能

#### 1.1.1 Summary 标签页缺失 ⭐⭐⭐
**问题描述**:
- `app.js` 中 `parseMarkdownSections` 函数已解析 `summary` 部分
- `BASE_SECTION_ALIASES` 中定义了 summary 的别名
- 但 `viewer.html` 中的 tabs 没有对应的 summary 标签页

**影响**:
- Book 1 的"文章概要"内容无法显示
- 用户无法快速了解文章大意

**解决方案**:
```javascript
// 需要在 viewer.html 的 tabs 中添加:
<button class="tab-btn" data-tab="summary" onclick="switchTab('summary', this)">文章概要</button>

// 并在 tab-content 中添加:
<div id="summary" class="tab-pane">
    <!-- Summary content -->
</div>
```

**优先级**: 高
**预计工时**: 2小时

---

#### 1.1.2 音频朗读功能 ⭐⭐⭐
**功能需求**:
- 单词发音播放
- 整段文章朗读
- 朗读速度调节(0.5x, 0.75x, 1x, 1.25x, 1.5x)
- 暂停/继续控制

**技术方案**:
- 使用 Web Speech API (speechSynthesis)
- 为每个单词添加发音按钮
- 添加全文朗读控制面板

**文件修改**:
- `viewer.html`: 添加音频控制按钮
- `app.js`: 实现 TTS 功能
- `styles.css`: 音频控制面板样式

**优先级**: 高
**预计工时**: 8小时

---

#### 1.1.3 搜索功能 ⭐⭐
**功能需求**:
- 全局单词搜索
- 内容全文搜索
- 搜索结果高亮显示
- 支持模糊搜索

**界面设计**:
```
[搜索框] 🔍
↓
[搜索结果]
- Group 5: "apply" 出现 3 次
- Group 12: "apply" 出现 2 次
```

**技术方案**:
- 使用 localStorage 缓存所有文章内容
- 实现客户端搜索引擎
- 支持正则表达式搜索

**优先级**: 中
**预计工时**: 12小时

---

#### 1.1.4 学习统计图表 ⭐⭐
**功能需求**:
- 进度可视化图表(饼图/柱状图)
- 学习时间统计
- 每日学习词汇量
- 学习热力图(类似 GitHub contributions)

**技术方案**:
- 使用 Chart.js 或 ECharts
- 记录每日学习时长和词汇量
- localStorage 存储学习数据

**界面位置**: 首页统计区域下方

**优先级**: 中
**预计工时**: 10小时

---

#### 1.1.5 导出功能 ⭐
**功能需求**:
- 导出学习笔记(Markdown/PDF)
- 导出学习进度报告
- 导出生词本
- 导出错题集

**技术方案**:
- Markdown: 直接拼接字符串
- PDF: 使用 jsPDF 库
- 提供下载链接

**优先级**: 低
**预计工时**: 6小时

---

#### 1.1.6 生词本功能 ⭐⭐⭐
**功能需求**:
- 标记生词
- 生词列表管理
- 生词复习模式
- 生词导出

**数据结构**:
```javascript
{
  word: "apply",
  groupNum: 1,
  addedDate: "2025-11-17",
  reviewCount: 3,
  mastered: false
}
```

**优先级**: 高
**预计工时**: 8小时

---

#### 1.1.7 复习提醒系统 ⭐⭐
**功能需求**:
- 基于遗忘曲线的复习提醒
- 浏览器通知 API
- 复习计划自动生成
- 复习进度跟踪

**复习间隔**:
- 第1次: 学习后1天
- 第2次: 学习后3天
- 第3次: 学习后7天
- 第4次: 学习后15天
- 第5次: 学习后30天

**优先级**: 中
**预计工时**: 10小时

---

#### 1.1.8 离线支持 (PWA) ⭐⭐
**功能需求**:
- Service Worker 缓存
- 离线可用
- 添加到主屏幕
- 离线数据同步

**技术方案**:
- 创建 `manifest.json`
- 实现 Service Worker
- 缓存所有静态资源和学习材料

**优先级**: 中
**预计工时**: 12小时

---

### 1.2 辅助功能

#### 1.2.1 单词卡片模式 ⭐⭐
**功能描述**: 翻转卡片式单词记忆
- 正面: 英文单词
- 背面: 中文释义、例句
- 支持键盘操作(空格翻转,左右键切换)

**优先级**: 中
**预计工时**: 6小时

---

#### 1.2.2 听写模式 ⭐
**功能描述**:
- 播放单词发音
- 用户输入单词
- 自动校验正确性
- 统计正确率

**优先级**: 低
**预计工时**: 8小时

---

#### 1.2.3 测试模式 ⭐⭐
**功能描述**:
- 选择题测试
- 填空题测试
- 拼写测试
- 测试结果分析

**优先级**: 中
**预计工时**: 15小时

---

## 🟡 二、逻辑未闭环的部分

### 2.1 数据完整性问题

#### 2.1.1 Book 1 缺少 group100 文件 ⭐⭐⭐
**问题**:
- 配置显示 Book 1 有 100 组
- 实际只有 99 个文件 (group1-group99)
- 缺少 `group100_reading.md`

**影响**:
- 用户跳转到 Group 100 会报错
- 进度计算不准确

**解决方案**:
```bash
# 需要创建 group100_reading.md 文件
# 或修改配置: totalGroups: 99
```

**优先级**: 高
**预计工时**: 1小时(创建文件) 或 0.5小时(修改配置)

---

#### 2.1.2 URL 参数验证不足 ⭐⭐
**问题位置**: `app.js` 第 440-451 行
```javascript
currentGroup = parseInt(getUrlParameter('group')) || 1;

// 仅做了简单的范围限制,没有验证 NaN 和非法值
if (currentGroup < 1) currentGroup = 1;
if (currentGroup > totalGroups) currentGroup = totalGroups;
```

**风险**:
- URL: `viewer.html?group=abc` 会导致 NaN
- URL: `viewer.html?group=-999` 可能导致异常
- 没有验证 book 参数的合法性

**改进方案**:
```javascript
function validateGroupNumber(value, totalGroups) {
    const num = parseInt(value);
    if (isNaN(num) || num < 1) return 1;
    if (num > totalGroups) return totalGroups;
    return num;
}

function validateBookParameter(value) {
    return BOOK_CONFIGS.hasOwnProperty(value) ? value : 'book1';
}
```

**优先级**: 高
**预计工时**: 2小时

---

#### 2.1.3 错误处理不完善 ⭐⭐
**问题位置**: `app.js` 第 174-189 行
```javascript
async function loadMarkdown(groupNum, book = null) {
    try {
        const response = await fetch(filePath);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return text;
    } catch (error) {
        console.error('Error loading markdown:', error);
        return null;  // 仅返回 null,用户体验差
    }
}
```

**问题**:
- 网络错误时只有 console 输出,用户看不到
- 没有重试机制
- 没有友好的错误提示

**改进方案**:
```javascript
async function loadMarkdown(groupNum, book = null, retryCount = 3) {
    for (let i = 0; i < retryCount; i++) {
        try {
            const response = await fetch(filePath);
            if (!response.ok) {
                if (response.status === 404) {
                    showErrorMessage('文件不存在,可能该组内容尚未准备');
                    return null;
                }
                throw new Error(`HTTP ${response.status}`);
            }
            return await response.text();
        } catch (error) {
            if (i === retryCount - 1) {
                showErrorMessage('加载失败,请检查网络连接');
                return null;
            }
            await sleep(1000 * (i + 1)); // 指数退避
        }
    }
}
```

**优先级**: 高
**预计工时**: 3小时

---

#### 2.1.4 书籍切换时的状态同步 ⭐⭐
**问题位置**: `app.js` 第 286-298 行
```javascript
function switchBook(book) {
    currentBook = book;
    saveCurrentBook(book);

    // 更新按钮状态
    document.querySelectorAll('.book-btn').forEach(btn => btn.classList.remove('active'));
    document.getElementById(book + 'Btn').classList.add('active');

    // 更新UI
    updateStats();
    renderGroupBatches();
    updateBookInfo();
}
```

**问题**:
- 切换书籍后,如果用户在 viewer 页面,没有自动刷新内容
- localStorage 中的笔记键名依赖 currentBook,但切换时可能出现不一致

**改进方案**:
- 添加全局事件监听
- 切换书籍时强制刷新 viewer 页面
- 统一状态管理(考虑使用 Vuex 或 Redux 模式)

**优先级**: 中
**预计工时**: 4小时

---

#### 2.1.5 Tab 可用性判断逻辑 ⭐
**问题位置**: `app.js` 第 620-631 行
```javascript
function setTabAvailability(sectionId, isAvailable) {
    const button = document.querySelector(`.tab-btn[data-tab="${sectionId}"]`);
    if (!button) return;
    button.classList.toggle('disabled', !isAvailable);
    if (!isAvailable) {
        if (button.classList.contains('active')) {
            button.classList.remove('active');
            document.getElementById(sectionId).classList.remove('active');
            ensureActiveTab();  // 可能导致无限循环
        }
    }
}
```

**风险**:
- 如果所有 tab 都不可用,`ensureActiveTab` 会陷入死循环
- 没有处理 Summary tab 不存在的情况

**改进方案**:
- 添加循环检测
- 设置默认的 fallback tab

**优先级**: 中
**预计工时**: 2小时

---

### 2.2 用户体验缺陷

#### 2.2.1 加载状态不明确 ⭐⭐
**问题**:
- 只有简单的 "正在加载内容..." 文字
- 没有加载进度指示
- 没有骨架屏

**改进方案**:
- 添加 Loading Spinner
- 实现骨架屏(Skeleton Screen)
- 显示加载进度百分比

**优先级**: 中
**预计工时**: 4小时

---

#### 2.2.2 笔记自动保存缺失 ⭐⭐⭐
**问题位置**: `app.js` 第 766-777 行
```javascript
function saveNotes() {
    const notes = document.getElementById('userNotes').value;
    const key = STORAGE_KEYS.USER_NOTES + currentBook + '_' + currentGroup;
    localStorage.setItem(key, notes);
    // 需要手动点击按钮保存
}
```

**问题**:
- 用户可能忘记保存
- 意外关闭页面会丢失笔记

**改进方案**:
```javascript
// 添加自动保存功能
let autoSaveTimer;
document.getElementById('userNotes').addEventListener('input', () => {
    clearTimeout(autoSaveTimer);
    autoSaveTimer = setTimeout(() => {
        saveNotes();
        showToast('笔记已自动保存', 'success');
    }, 2000);
});

// 页面卸载前保存
window.addEventListener('beforeunload', saveNotes);
```

**优先级**: 高
**预计工时**: 2小时

---

#### 2.2.3 键盘快捷键不完整 ⭐⭐
**问题位置**: `app.js` 第 806-837 行
```javascript
function setupKeyboardShortcuts() {
    // 只实现了:
    // - ArrowLeft/Right: 导航
    // - c: 标记完成
    // - h: 切换高亮
}
```

**缺少的快捷键**:
- `Tab`: 切换标签页
- `F`: 切换专注模式
- `S`: 保存笔记
- `1-6`: 快速切换到指定标签页
- `/`: 聚焦搜索框
- `Esc`: 关闭弹窗
- `Space`: 朗读/暂停

**优先级**: 中
**预计工时**: 3小时

---

## 🟢 三、需要优化的部分

### 3.1 性能优化

#### 3.1.1 Markdown 解析性能 ⭐⭐⭐
**问题位置**: `app.js` 第 192-258 行
```javascript
function parseMarkdownSections(markdown, bookKey = currentBook) {
    // 每次都重新解析,没有缓存
    // 正则表达式重复执行
}
```

**优化方案**:
```javascript
const markdownCache = new Map();

function parseMarkdownSections(markdown, bookKey = currentBook) {
    const cacheKey = `${bookKey}_${markdown.substring(0, 50)}`;

    if (markdownCache.has(cacheKey)) {
        return markdownCache.get(cacheKey);
    }

    const sections = /* 解析逻辑 */;
    markdownCache.set(cacheKey, sections);

    // 限制缓存大小
    if (markdownCache.size > 50) {
        const firstKey = markdownCache.keys().next().value;
        markdownCache.delete(firstKey);
    }

    return sections;
}
```

**预期提升**: 减少 70% 的解析时间
**优先级**: 高
**预计工时**: 3小时

---

#### 3.1.2 DOM 操作优化 ⭐⭐
**问题**: 频繁的 DOM 查询和操作

**优化方案**:
```javascript
// 缓存常用 DOM 元素
const domCache = {
    readingContent: null,
    groupTitle: null,
    // ...
};

function initDomCache() {
    domCache.readingContent = document.getElementById('readingContent');
    domCache.groupTitle = document.getElementById('groupTitle');
    // ...
}

// 使用 DocumentFragment 批量插入
function renderGroupBatches() {
    const fragment = document.createDocumentFragment();
    // 构建所有 batch
    container.appendChild(fragment);  // 一次性插入
}
```

**预期提升**: 减少 50% 的重排(reflow)
**优先级**: 中
**预计工时**: 4小时

---

#### 3.1.3 图片懒加载 ⭐
**当前状态**: 无图片资源
**未来需求**: 如果添加插图或图标

**技术方案**:
- 使用 Intersection Observer API
- 或使用 `loading="lazy"` 属性

**优先级**: 低
**预计工时**: 2小时

---

#### 3.1.4 代码分割和异步加载 ⭐⭐
**问题**: 所有代码打包在一个 `app.js` 中

**优化方案**:
```javascript
// 首页只加载必要代码
// 学习页面异步加载
const viewerModule = await import('./viewer-module.js');

// 使用动态导入
button.addEventListener('click', async () => {
    const { initChart } = await import('./chart-module.js');
    initChart();
});
```

**预期提升**: 减少初始加载时间 40%
**优先级**: 中
**预计工时**: 8小时

---

### 3.2 代码质量优化

#### 3.2.1 代码重复消除 ⭐⭐
**问题位置**: `app.js` 第 574-612 行
```javascript
function renderTranslation(content, heading = '') {
    renderSection('translation', content, heading);
}
function renderVocabulary(content, heading = '') {
    renderSection('vocabulary', content, heading);
}
// ... 5个相似函数
```

**优化方案**:
```javascript
// 使用函数工厂模式
const sectionRenderers = ['translation', 'vocabulary', 'sentences', 'memory', 'practice']
    .reduce((acc, section) => {
        acc[`render${capitalize(section)}`] = (content, heading) =>
            renderSection(section, content, heading);
        return acc;
    }, {});
```

**优先级**: 中
**预计工时**: 2小时

---

#### 3.2.2 魔法数字消除 ⭐⭐
**问题**: 代码中散布魔法数字
```javascript
// app.js:393
const estimatedMinutes = Math.max(5, Math.round(totalWordsInBatch / 20));

// app.js:504
const estimatedMinutes = Math.max(5, Math.round(bookConfig.wordsPerGroup / 10));
```

**优化方案**:
```javascript
const READING_CONSTANTS = {
    WORDS_PER_MINUTE: 20,
    MIN_READING_TIME: 5,
    CACHE_SIZE: 50,
    AUTO_SAVE_DELAY: 2000,
    TOAST_DURATION: 2000
};
```

**优先级**: 中
**预计工时**: 1小时

---

#### 3.2.3 类型安全 ⭐⭐
**问题**: 纯 JavaScript,无类型检查

**优化方案**:
- 迁移到 TypeScript
- 或使用 JSDoc 注释

```javascript
/**
 * 加载 Markdown 文件
 * @param {number} groupNum - 组号
 * @param {string|null} book - 书籍 ID
 * @param {number} [retryCount=3] - 重试次数
 * @returns {Promise<string|null>}
 */
async function loadMarkdown(groupNum, book = null, retryCount = 3) {
    // ...
}
```

**优先级**: 低
**预计工时**: 20小时(TypeScript) 或 4小时(JSDoc)

---

#### 3.2.4 错误边界处理 ⭐⭐⭐
**问题**: 缺少全局错误捕获

**优化方案**:
```javascript
window.addEventListener('error', (event) => {
    console.error('Global error:', event.error);
    showErrorMessage('发生了意外错误,请刷新页面');

    // 可选: 发送错误到日志服务
    logError({
        message: event.error.message,
        stack: event.error.stack,
        url: window.location.href
    });
});

window.addEventListener('unhandledrejection', (event) => {
    console.error('Unhandled promise rejection:', event.reason);
    showErrorMessage('数据加载失败,请重试');
});
```

**优先级**: 高
**预计工时**: 2小时

---

### 3.3 样式和 UI 优化

#### 3.3.1 主题切换动画 ⭐
**问题**: 主题切换时颜色生硬变化

**优化方案**:
```css
/* styles.css */
* {
    transition: background-color 0.3s ease,
                color 0.3s ease,
                border-color 0.3s ease;
}

/* 但需要排除动画元素 */
.no-theme-transition {
    transition: none !important;
}
```

**优先级**: 低
**预计工时**: 2小时

---

#### 3.3.2 响应式设计改进 ⭐⭐
**问题位置**: `styles.css` 第 1039-1102 行

**当前断点**: 1024px, 768px, 480px
**问题**:
- 平板横屏(1024-1280px)体验不佳
- 小手机(<360px)布局异常

**优化方案**:
```css
/* 添加更多断点 */
@media (min-width: 1280px) { /* 大屏优化 */ }
@media (max-width: 360px) { /* 小屏优化 */ }
@media (orientation: landscape) and (max-height: 600px) {
    /* 横屏优化 */
}
```

**优先级**: 中
**预计工时**: 6小时

---

#### 3.3.3 无障碍性(A11y)改进 ⭐⭐
**当前问题**:
- 缺少 ARIA 标签
- 键盘导航不完整
- 颜色对比度未验证
- 没有 skip-to-content 链接

**改进方案**:
```html
<!-- 添加 ARIA 标签 -->
<button class="tab-btn"
        data-tab="translation"
        role="tab"
        aria-selected="true"
        aria-controls="translation-panel">
    中文翻译
</button>

<div id="translation-panel"
     role="tabpanel"
     aria-labelledby="translation-tab">
    <!-- content -->
</div>

<!-- 添加跳转链接 -->
<a href="#main-content" class="skip-link">跳到主要内容</a>
```

**优先级**: 中
**预计工时**: 8小时

---

#### 3.3.4 深色模式优化 ⭐
**问题**: 深色模式下某些元素对比度不足

**优化方案**:
- 使用在线工具验证对比度(WCAG AA 标准 ≥ 4.5:1)
- 调整颜色值

**优先级**: 低
**预计工时**: 3小时

---

### 3.4 架构优化

#### 3.4.1 状态管理 ⭐⭐⭐
**问题**: 状态散落在全局变量中
```javascript
let currentGroup = 1;
let currentFontSize = 16;
let boldVisible = true;
let focusMode = false;
let currentBook = 'book1';
```

**优化方案**: 实现简单的状态管理
```javascript
class AppState {
    constructor() {
        this.state = {
            currentGroup: 1,
            currentBook: 'book1',
            fontSize: 16,
            boldVisible: true,
            focusMode: false,
            theme: 'light'
        };
        this.listeners = [];
    }

    setState(updates) {
        this.state = { ...this.state, ...updates };
        this.notifyListeners();
    }

    subscribe(listener) {
        this.listeners.push(listener);
    }

    notifyListeners() {
        this.listeners.forEach(fn => fn(this.state));
    }
}

const appState = new AppState();
```

**优先级**: 高
**预计工时**: 10小时

---

#### 3.4.2 模块化重构 ⭐⭐
**问题**: 单一 `app.js` 文件过大(868行)

**重构方案**:
```
src/
├── core/
│   ├── state.js          # 状态管理
│   ├── storage.js        # LocalStorage 封装
│   └── config.js         # 配置常量
├── utils/
│   ├── markdown.js       # Markdown 解析
│   ├── dom.js            # DOM 工具
│   └── validation.js     # 验证函数
├── features/
│   ├── theme.js          # 主题切换
│   ├── notes.js          # 笔记功能
│   ├── progress.js       # 进度追踪
│   └── navigation.js     # 导航功能
└── main.js               # 入口文件
```

**优先级**: 中
**预计工时**: 16小时

---

#### 3.4.3 测试覆盖 ⭐⭐
**当前状态**: 无单元测试

**测试方案**:
```javascript
// 使用 Jest
describe('parseMarkdownSections', () => {
    it('should parse reading section correctly', () => {
        const markdown = '# Title\n## Reading\nContent';
        const result = parseMarkdownSections(markdown);
        expect(result.reading).toBe('Content');
    });

    it('should handle missing sections gracefully', () => {
        const result = parseMarkdownSections('');
        expect(result.reading).toBe('');
    });
});
```

**测试覆盖目标**: 80%
**优先级**: 中
**预计工时**: 20小时

---

### 3.5 数据持久化优化

#### 3.5.1 IndexedDB 替代 LocalStorage ⭐⭐
**问题**: LocalStorage 有容量限制(~5-10MB)

**优化方案**:
```javascript
// 使用 IndexedDB 存储大量数据
class StorageManager {
    async init() {
        this.db = await openDB('coca-learning', 1, {
            upgrade(db) {
                db.createObjectStore('notes', { keyPath: 'id' });
                db.createObjectStore('progress', { keyPath: 'groupId' });
                db.createObjectStore('vocabulary', { keyPath: 'word' });
            }
        });
    }

    async saveNote(groupId, content) {
        await this.db.put('notes', { id: groupId, content });
    }
}
```

**优先级**: 中
**预计工时**: 8小时

---

#### 3.5.2 数据备份和恢复 ⭐⭐
**功能需求**:
- 导出所有学习数据为 JSON
- 导入备份数据
- 云端同步(可选)

**优先级**: 中
**预计工时**: 10小时

---

## 🎯 四、开发优先级建议

### P0 - 立即修复(1-2周)
1. ✅ Book 1 缺少 group100 文件
2. ✅ Summary 标签页缺失
3. ✅ URL 参数验证不足
4. ✅ 错误处理不完善
5. ✅ 笔记自动保存

**总工时**: ~15 小时

---

### P1 - 高优先级(1个月)
1. 🎵 音频朗读功能
2. 📚 生词本功能
3. 📊 状态管理重构
4. ⚡ Markdown 解析性能优化
5. 🔍 错误边界处理

**总工时**: ~40 小时

---

### P2 - 中优先级(2-3个月)
1. 🔎 搜索功能
2. 📈 学习统计图表
3. 🔔 复习提醒系统
4. 📱 PWA 离线支持
5. ♿ 无障碍性改进
6. 🧩 模块化重构
7. 🗄️ IndexedDB 存储

**总工时**: ~100 小时

---

### P3 - 低优先级(长期规划)
1. 📝 单词卡片模式
2. 🎧 听写模式
3. 📝 测试模式
4. 💾 导出功能
5. 📦 TypeScript 迁移
6. 🧪 测试覆盖

**总工时**: ~80 小时

---

## 📋 五、技术债务清单

### 技术债务 #1: 全局变量污染
**位置**: `app.js` 全局作用域
**影响**: 命名冲突风险
**解决**: 使用 IIFE 或 ES6 模块

---

### 技术债务 #2: 硬编码字符串
**位置**: 多处
**影响**: 难以国际化
**解决**: 提取到配置对象

---

### 技术债务 #3: 缺少版本控制
**影响**: LocalStorage 数据结构变化时兼容性问题
**解决**:
```javascript
const STORAGE_VERSION = 1;
function migrateStorage(oldVersion, newVersion) {
    // 数据迁移逻辑
}
```

---

## 🚀 六、实施建议

### 6.1 开发流程
1. **需求确认**: 与产品/用户确认功能优先级
2. **技术评估**: 评估每个功能的技术可行性
3. **原型设计**: 关键功能先做原型验证
4. **迭代开发**: 按 P0 → P1 → P2 → P3 顺序开发
5. **测试验证**: 每个功能开发完成后进行测试
6. **用户反馈**: 灰度发布,收集反馈

---

### 6.2 代码规范
- 使用 ESLint + Prettier
- 提交前进行 Lint 检查
- 遵循 [Airbnb JavaScript Style Guide](https://github.com/airbnb/javascript)

---

### 6.3 文档维护
- 每个新功能需要更新用户文档
- 关键函数需要 JSDoc 注释
- 维护 CHANGELOG.md

---

### 6.4 性能监控
```javascript
// 添加性能监控
performance.mark('load-start');
await loadMarkdown(1);
performance.mark('load-end');
performance.measure('load-time', 'load-start', 'load-end');
const measure = performance.getEntriesByName('load-time')[0];
console.log(`Load time: ${measure.duration}ms`);
```

---

## 📊 七、工时估算总览

| 类别 | 功能数 | 总工时 |
|------|--------|--------|
| P0 立即修复 | 5 | 15h |
| P1 高优先级 | 5 | 40h |
| P2 中优先级 | 7 | 100h |
| P3 低优先级 | 6 | 80h |
| **总计** | **23** | **235h** |

**预计全职开发时间**: 约 6 周(按每周 40 小时计算)

---

## 🎓 八、学习资源推荐

### 8.1 性能优化
- [Web Performance Fundamentals](https://frontendmasters.com/courses/web-performance/)
- [Chrome DevTools Performance](https://developers.google.com/web/tools/chrome-devtools/evaluate-performance)

### 8.2 PWA 开发
- [PWA Training](https://web.dev/progressive-web-apps/)
- [Workbox Guide](https://developers.google.com/web/tools/workbox)

### 8.3 无障碍性
- [WCAG Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [A11y Project](https://www.a11yproject.com/)

---

## 📝 九、版本规划

### v1.1.0 (当前版本 + P0修复)
- ✅ 修复 group100 缺失
- ✅ 添加 Summary 标签页
- ✅ 改进错误处理
- ✅ 笔记自动保存

---

### v1.2.0 (P1 功能)
- 🎵 音频朗读
- 📚 生词本
- 📊 状态管理重构
- ⚡ 性能优化

---

### v2.0.0 (P2 功能)
- 🔎 搜索系统
- 📈 统计图表
- 🔔 复习提醒
- 📱 PWA 支持
- 🧩 模块化架构

---

### v3.0.0 (P3 功能 + 重大升级)
- 📝 测试系统
- 💾 数据导出
- 🌐 国际化
- 📦 TypeScript 重写

---

## ⚠️ 十、风险和注意事项

### 10.1 浏览器兼容性
- Web Speech API 兼容性有限
- IndexedDB 在私密模式下可能不可用
- Service Worker 需要 HTTPS

**解决方案**: 提供降级方案,检测特性支持

---

### 10.2 性能风险
- 大量 Markdown 文件可能导致加载缓慢
- IndexedDB 操作是异步的,需要处理竞态条件

**解决方案**: 懒加载、虚拟滚动、防抖节流

---

### 10.3 数据迁移
- 修改 localStorage 结构时需要迁移旧数据

**解决方案**: 版本控制 + 自动迁移脚本

---

## 🎉 十一、总结

这份开发计划清单详细梳理了项目的:
- ❌ **23 个未完成的功能**
- ⚠️ **8 个逻辑未闭环的部分**
- 🔧 **15 个需要优化的地方**

按照优先级实施后,预计可以:
- 📈 **提升 50% 用户体验**
- ⚡ **提升 70% 性能**
- 🐛 **减少 90% 的潜在 Bug**

**下一步行动**: 从 P0 优先级开始,逐步完善系统功能。

---

**文档维护者**: Claude AI
**最后更新**: 2025-11-17
**版本**: 1.0
